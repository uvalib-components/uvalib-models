<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../polymerfire/firebase-document.html">
<link rel="import" href="../app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="firebase-app.html">

<!--
`uvalib-model-file`
data model for the files used for the Library site

@demo demo/file.html
-->

<dom-module id="uvalib-model-file">
  <template>
    <template is="dom-if" if="[[uuid]]">
      <firebase-document id="query" app-name="uvalibapi"
        path="[[_dbPath(uuid)]]"
        data="{{tmpData}}"></firebase-document>
      <app-indexeddb-mirror
          key="file-[[uuid]]"
          data="[[tmpData]]"
          persisted-data="{{data}}"></app-indexeddb-mirror>
    </template>
  </template>

  <script>
    Polymer({

      is: 'uvalib-model-file',
      properties: {
        uuid: {
          type: String,
          value: null
        },
        /**
         * The file
         *
         * @type Object
         */
        data: {
          type: Object,
          value: null,
          notify: true
        },
        rawData: {
          type: String,
          computed: '_toString(data)',
          notify: true
        }
      },
      _toString: function(data){
        return JSON.stringify(data);
      },
      _dbPath: function(uuid){
        return '/files/'+uuid;
      }
    });
  </script>
</dom-module>
